python -m venv .venv
./.venv/Scripts/activate
pip install -r requirements.txt
æŠ¥é”™äº† ä¸´æ—¶ç›´æ¥å®‰è£…ç›¸å…³åŒ…
pip install autogen-agentchat autogen-ext[openai] python-dotenv requests

(.venv) PS D:\project\hello-agents\code\chapter6\AutoGenDemo> python .\autogen_software_team.py
ğŸ”§ æ­£åœ¨åˆå§‹åŒ–æ¨¡å‹å®¢æˆ·ç«¯...
D:\project\hello-agents\code\chapter6\AutoGenDemo\.venv\Lib\site-packages\autogen_ext\models\openai_openai_client.py:466: UserWarning: Missing required field 'structured_output' in ModelInfo. This field will be required in a future version of AutoGen.  
 validate_model_info(self.\_model_info)
ğŸ‘¥ æ­£åœ¨åˆ›å»ºæ™ºèƒ½ä½“å›¢é˜Ÿ...
ğŸš€ å¯åŠ¨ AutoGen è½¯ä»¶å¼€å‘å›¢é˜Ÿåä½œ...
============================================================  
---------- TextMessage (user) ----------
æˆ‘ä»¬éœ€è¦å¼€å‘ä¸€ä¸ªæ¯”ç‰¹å¸ä»·æ ¼æ˜¾ç¤ºåº”ç”¨ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š

æ ¸å¿ƒåŠŸèƒ½ï¼š

- å®æ—¶æ˜¾ç¤ºæ¯”ç‰¹å¸å½“å‰ä»·æ ¼ï¼ˆUSDï¼‰
- æ˜¾ç¤º 24 å°æ—¶ä»·æ ¼å˜åŒ–è¶‹åŠ¿ï¼ˆæ¶¨è·Œå¹…å’Œæ¶¨è·Œé¢ï¼‰
- æä¾›ä»·æ ¼åˆ·æ–°åŠŸèƒ½

æŠ€æœ¯è¦æ±‚ï¼š

- ä½¿ç”¨ Streamlit æ¡†æ¶åˆ›å»º Web åº”ç”¨
- ç•Œé¢ç®€æ´ç¾è§‚ï¼Œç”¨æˆ·å‹å¥½
- æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†å’ŒåŠ è½½çŠ¶æ€

è¯·å›¢é˜Ÿåä½œå®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œä»éœ€æ±‚åˆ†æåˆ°æœ€ç»ˆå®ç°ã€‚
---------- TextMessage (ProductManager) ----------
å¥½çš„ï¼Œæ”¶åˆ°éœ€æ±‚ã€‚ä¸‹é¢æ˜¯é’ˆå¯¹æ¯”ç‰¹å¸ä»·æ ¼æ˜¾ç¤ºåº”ç”¨çš„åˆ†æï¼š

**1. éœ€æ±‚ç†è§£ä¸åˆ†æï¼š**

- **ç”¨æˆ·æ ¸å¿ƒéœ€æ±‚ï¼š** å¿«é€Ÿã€å‡†ç¡®åœ°è·å–æ¯”ç‰¹å¸å®æ—¶ä»·æ ¼å’Œ 24 å°æ—¶ä»·æ ¼å˜åŠ¨ä¿¡æ¯ã€‚
- **åŠŸèƒ½æ€§éœ€æ±‚ï¼š**
  - å®æ—¶ä»·æ ¼æ˜¾ç¤ºï¼š ä»å¯é çš„ API è·å–å¹¶æ˜¾ç¤ºæ¯”ç‰¹å¸å½“å‰ä»·æ ¼ï¼ˆUSDï¼‰ã€‚
  - 24 å°æ—¶ä»·æ ¼å˜åŒ–ï¼š æ˜¾ç¤º 24 å°æ—¶å†…çš„ä»·æ ¼æ¶¨è·Œå¹…ï¼ˆç™¾åˆ†æ¯”ï¼‰å’Œæ¶¨è·Œé¢ï¼ˆUSDï¼‰ã€‚
  - ä»·æ ¼åˆ·æ–°ï¼š æä¾›æ‰‹åŠ¨åˆ·æ–°ä»·æ ¼çš„åŠŸèƒ½ã€‚
- **éåŠŸèƒ½æ€§éœ€æ±‚ï¼š**
  - ç•Œé¢ï¼š ç®€æ´ç¾è§‚ï¼Œç”¨æˆ·ä½“éªŒå‹å¥½ã€‚
  - æ€§èƒ½ï¼š å¿«é€Ÿå“åº”ï¼Œå®æ—¶æ›´æ–°ã€‚
  - ç¨³å®šæ€§ï¼š é”™è¯¯å¤„ç†ï¼Œåº”å¯¹ API æ•…éšœç­‰å¼‚å¸¸æƒ…å†µã€‚
  - æ˜“ç”¨æ€§ï¼š æ˜“äºå®‰è£…å’Œä½¿ç”¨ã€‚

**2. åŠŸèƒ½æ¨¡å—åˆ’åˆ†ï¼š**

- **æ•°æ®è·å–æ¨¡å—ï¼š**
  - è´Ÿè´£ä» API è·å–æ¯”ç‰¹å¸ä»·æ ¼æ•°æ®ã€‚
  - å¤„ç† API è¯·æ±‚ï¼Œè§£æè¿”å›æ•°æ®ã€‚
  - é”™è¯¯å¤„ç†ï¼š API è¯·æ±‚å¤±è´¥é‡è¯•ï¼Œå¼‚å¸¸æ•°æ®å¤„ç†ã€‚
- **æ•°æ®å¤„ç†æ¨¡å—ï¼š**
  - è®¡ç®— 24 å°æ—¶ä»·æ ¼å˜åŒ–ï¼ˆæ¶¨è·Œå¹…å’Œæ¶¨è·Œé¢ï¼‰ã€‚
  - æ ¼å¼åŒ–ä»·æ ¼æ•°æ®ï¼Œæ–¹ä¾¿æ˜¾ç¤ºã€‚
- **UI æ˜¾ç¤ºæ¨¡å—ï¼š**
  - ä½¿ç”¨ Streamlit æ¡†æ¶æ„å»º Web ç•Œé¢ã€‚
  - æ˜¾ç¤ºå®æ—¶ä»·æ ¼ã€‚
  - æ˜¾ç¤º 24 å°æ—¶ä»·æ ¼å˜åŒ–ä¿¡æ¯ã€‚
  - æä¾›åˆ·æ–°æŒ‰é’®ã€‚
  - åŠ è½½çŠ¶æ€æ˜¾ç¤ºã€‚
  - é”™è¯¯ä¿¡æ¯æç¤ºã€‚

**3. æŠ€æœ¯é€‰å‹å»ºè®®ï¼š**

- **ç¼–ç¨‹è¯­è¨€ï¼š** Python (Streamlit æ¡†æ¶è¦æ±‚)
- **Web æ¡†æ¶ï¼š** Streamlit (éœ€æ±‚æŒ‡å®š)
- **API é€‰æ‹©ï¼š** CoinGecko æˆ– Binance API (æ ¹æ®ç¨³å®šæ€§å’Œæ•°æ®å‡†ç¡® æ€§é€‰æ‹©, éœ€è¦ç”³è¯· API Key)
- **æ•°æ®å¤„ç†åº“ï¼š** pandas, numpy (å¯é€‰ï¼Œç”¨äºæ›´å¤æ‚çš„æ•°æ®å¤„ç†)
- **å®šæ—¶ä»»åŠ¡åº“ï¼š** schedule (å¦‚æœéœ€è¦è‡ªåŠ¨åˆ·æ–°æ•°æ®)

**4. å®ç°ä¼˜å…ˆçº§æ’åºï¼š**

1.  **æ ¸å¿ƒåŠŸèƒ½ï¼š** å®æ—¶ä»·æ ¼æ˜¾ç¤º (ä» API è·å–å¹¶æ˜¾ç¤º)
2.  **åŸºæœ¬åŠŸèƒ½ï¼š** 24 å°æ—¶ä»·æ ¼å˜åŒ– (æ¶¨è·Œå¹…å’Œæ¶¨è·Œé¢)
3.  **ç”¨æˆ·ä½“éªŒï¼š** ç•Œé¢ç¾åŒ–ï¼ŒåŠ è½½çŠ¶æ€æ˜¾ç¤º
4.  **å¥å£®æ€§ï¼š** é”™è¯¯å¤„ç†ï¼ŒAPI å¼‚å¸¸å¤„ç†
5.  **å¯é€‰åŠŸèƒ½ï¼š** è‡ªåŠ¨åˆ·æ–° (å®šæ—¶ä»»åŠ¡)

**5. éªŒæ”¶æ ‡å‡†å®šä¹‰ï¼š**

- **ä»·æ ¼å‡†ç¡®æ€§ï¼š** æ˜¾ç¤ºçš„ä»·æ ¼ä¸é€‰å®šçš„ API æ•°æ®æºä¸€è‡´ã€‚
- **åˆ·æ–°åŠŸèƒ½ï¼š** ç‚¹å‡»åˆ·æ–°æŒ‰é’®åï¼Œä»·æ ¼èƒ½å¤ŸåŠæ—¶æ›´æ–°ã€‚
- **24 å°æ—¶å˜åŒ–ï¼š** æ¶¨è·Œå¹…å’Œæ¶¨è·Œé¢è®¡ç®—æ­£ç¡®ã€‚
- **é”™è¯¯å¤„ç†ï¼š** API è¯·æ±‚å¤±è´¥æˆ–æ•°æ®å¼‚å¸¸æ—¶ï¼Œèƒ½ç»™å‡ºå‹å¥½çš„æç¤ºä¿¡æ¯ ï¼Œé¿å…ç¨‹åºå´©æºƒã€‚
- **ç•Œé¢å‹å¥½ï¼š** ç•Œé¢ç®€æ´ç¾è§‚ï¼Œæ˜“äºä½¿ç”¨ã€‚

è¯·å·¥ç¨‹å¸ˆå¼€å§‹å®ç°ã€‚

---------- TextMessage (Engineer) ----------
å¥½çš„ï¼Œæ ¹æ®ä¹‹å‰çš„åˆ†æï¼Œä¸‹é¢æ˜¯ä½¿ç”¨ Streamlit å®ç°æ¯”ç‰¹å¸ä»·æ ¼æ˜¾ç¤ºåº”ç”¨çš„ Python ä»£ç ã€‚æˆ‘é€‰æ‹© CoinGecko APIï¼Œå› ä¸ºå®ƒä½¿ç”¨ç®€å•ï¼Œæ— éœ€ API å¯†é’¥ã€‚

```python
import streamlit as st
import requests
import json
import time

def get_bitcoin_price():
    """ä» CoinGecko API è·å–æ¯”ç‰¹å¸ä»·æ ¼"""
    try:
        url = "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true"
        response = requests.get(url)
        response.raise_for_status()  # æ£€æŸ¥æ˜¯å¦æœ‰ HTTP é”™è¯¯
        data = response.json()
        return data['bitcoin']['usd'], data['bitcoin']['usd_24h_change']
    except requests.exceptions.RequestException as e:
        st.error(f"API è¯·æ±‚é”™è¯¯: {e}")
        return None, None
    except (KeyError, TypeError) as e:
        st.error(f"API å“åº”æ•°æ®é”™è¯¯: {e}")
        return None, None

def main():
    """ä¸»å‡½æ•°ï¼Œç”¨äºåˆ›å»º Streamlit åº”ç”¨"""
    st.title("æ¯”ç‰¹å¸ (Bitcoin) å®æ—¶ä»·æ ¼")

    # ä½¿ç”¨ Streamlit çš„çŠ¶æ€ç®¡ç†æ¥é¿å…æ¯æ¬¡åˆ·æ–°éƒ½é‡æ–°è·å–æ•°æ®
    if 'price' not in st.session_state:
        st.session_state['price'] = None
        st.session_state['change'] = None

    # è·å–ä»·æ ¼å¹¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    with st.spinner('æ­£åœ¨åŠ è½½æ¯”ç‰¹å¸ä»·æ ¼...'):
        price, change = get_bitcoin_price()
        st.session_state['price'] = price
        st.session_state['change'] = change

    # æ˜¾ç¤ºä»·æ ¼ä¿¡æ¯
    if st.session_state['price'] is not None:
        st.metric(label="å½“å‰ä»·æ ¼ (USD)", value=f"${st.session_state['price']:.2f}", delta=f"{st.session_state['change']:.2f}%")
    else:
        st.error("æ— æ³•è·å–æ¯”ç‰¹å¸ä»·æ ¼ï¼Œè¯·ç¨åå†è¯•ã€‚")

    # åˆ·æ–°æŒ‰é’®
    if st.button("åˆ·æ–°ä»·æ ¼"):
        with st.spinner('æ­£åœ¨åˆ·æ–°æ¯”ç‰¹å¸ä»·æ ¼...'):
            price, change = get_bitcoin_price()
            st.session_state['price'] = price
            st.session_state['change'] = change
            # å¼ºåˆ¶ Streamlit é‡æ–°è¿è¡Œä»¥æ›´æ–° UI
            st.rerun()

if __name__ == "__main__":
    main()
```

**ä»£ç è§£é‡Š:**

1.  **å¯¼å…¥å¿…è¦çš„åº“:**

    - `streamlit` ç”¨äºåˆ›å»º Web åº”ç”¨ã€‚
    - `requests` ç”¨äºå‘é€ HTTP è¯·æ±‚åˆ° CoinGecko APIã€‚
    - `json` ç”¨äºå¤„ç† API è¿”å›çš„ JSON æ•°æ®ã€‚
    - `time` ç”¨äºæ·»åŠ å»¶è¿Ÿï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚

2.  **`get_bitcoin_price()` å‡½æ•°:**

    - å‘é€ GET è¯·æ±‚åˆ° CoinGecko API è·å–æ¯”ç‰¹å¸ä»·æ ¼ï¼ˆUSDï¼‰å’Œ 24 å°æ—¶ä»·æ ¼å˜åŒ–ã€‚
    - ä½¿ç”¨ `try...except` å—å¤„ç†å¯èƒ½çš„å¼‚å¸¸ï¼Œå¦‚ç½‘ç»œé”™è¯¯æˆ– API è¿”å›æ•°æ®æ ¼å¼é”™è¯¯ã€‚
    - å¦‚æœå‡ºç°é”™è¯¯ï¼Œåœ¨ Streamlit åº”ç”¨ä¸­æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œå¹¶è¿”å› `None`ã€‚
    - `response.raise_for_status()`ï¼šæ£€æŸ¥ HTTP å“åº”çŠ¶æ€ç ï¼Œå¦‚æœçŠ¶æ€ç è¡¨ç¤ºé”™è¯¯ï¼ˆä¾‹å¦‚ 404 æˆ– 500ï¼‰ï¼Œåˆ™ä¼šå¼•å‘ HTTPError å¼‚å¸¸ã€‚

3.  **`main()` å‡½æ•°:**
    - ä½¿ç”¨ `st.title()` è®¾ç½®åº”ç”¨æ ‡é¢˜ã€‚
    - ä½¿ç”¨ `st.session_state` ç®¡ç†çŠ¶æ€ï¼Œé¿å…ä¸å¿…è¦çš„ API è°ƒç”¨ã€‚`st.session_state` æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå¯ä»¥åœ¨ Streamlit åº”ç”¨çš„å¤šæ¬¡è¿è¡Œä¹‹ é—´ä¿å­˜çŠ¶æ€ã€‚
    - ä½¿ç”¨ `st.spinner()` æ˜¾ç¤ºåŠ è½½çŠ¶æ€ã€‚
    - è°ƒç”¨ `get_bitcoin_price()` å‡½æ•°è·å–æ¯”ç‰¹å¸ä»·æ ¼ã€‚
    - ä½¿ç”¨ `st.metric()` æ˜¾ç¤ºå½“å‰ä»·æ ¼å’Œ 24 å°æ—¶ä»·æ ¼å˜åŒ–ã€‚`st.metric` æ˜¯ Streamlit ä¸­ç”¨äºæ˜¾ç¤ºæŒ‡æ ‡æ•°æ®çš„ä¾¿æ·æ–¹æ³•ï¼Œå¯ä»¥åŒæ—¶æ˜¾ç¤ºæ ‡ç­¾ã€å½“å‰å€¼å’Œå˜åŒ–é‡ï¼ˆdeltaï¼‰ã€‚
    - ä½¿ç”¨ `st.button()` æ·»åŠ åˆ·æ–°æŒ‰é’®ã€‚ å½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œé‡æ–°è·å– ä»·æ ¼å¹¶æ›´æ–° UIã€‚
    - `st.rerun()` ç”¨äºé‡æ–°è¿è¡Œæ•´ä¸ª Streamlit åº”ç”¨ç¨‹åºã€‚è¿™ç¡®ä¿ äº†åœ¨ç‚¹å‡» "åˆ·æ–°ä»·æ ¼" æŒ‰é’®åï¼ŒUI ä¼šä½¿ç”¨æœ€æ–°çš„æ•°æ®è¿›è¡Œæ›´æ–°ã€‚

**å¦‚ä½•è¿è¡Œ:**

1.  ç¡®ä¿ä½ å·²ç»å®‰è£…äº† Streamlit å’Œ requests åº“ï¼š
    ```bash
    pip install streamlit requests
    ```
2.  å°†ä»£ç ä¿å­˜ä¸º Python æ–‡ä»¶ï¼ˆä¾‹å¦‚ `bitcoin_price.py`ï¼‰ã€‚
3.  åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ Streamlit åº”ç”¨ï¼š
    ```bash
    streamlit run bitcoin_price.py
    ```
4.  Streamlit å°†åœ¨ä½ çš„æµè§ˆå™¨ä¸­æ‰“å¼€åº”ç”¨ã€‚

**æ”¹è¿›æ–¹å‘:**

- **é€‰æ‹©å…¶ä»– API:** å¦‚æœ CoinGecko ä¸ç¨³å®šï¼Œå¯ä»¥è€ƒè™‘ Binance æˆ–å…¶ä»–æä¾›æ¯”ç‰¹å¸ä»·æ ¼çš„ APIã€‚
- **è‡ªåŠ¨åˆ·æ–°:** å¯ä»¥ä½¿ç”¨ `time.sleep()` å’Œ `st.rerun()` æ¥å® ç°è‡ªåŠ¨åˆ·æ–°ï¼Œä½†éœ€è¦å°å¿ƒæ§åˆ¶åˆ·æ–°é¢‘ç‡ï¼Œé¿å…è¿‡äºé¢‘ç¹åœ°è°ƒç”¨ APIã€‚
- **å›¾è¡¨æ˜¾ç¤º:** å¯ä»¥ä½¿ç”¨ Streamlit çš„å›¾è¡¨ç»„ä»¶æ˜¾ç¤ºå†å²ä»·æ ¼æ•°æ® ã€‚
- **æ ·å¼ç¾åŒ–:** å¯ä»¥ä½¿ç”¨ Streamlit çš„ä¸»é¢˜è®¾ç½®å’Œè‡ªå®šä¹‰ CSS æ¥ç¾åŒ–åº”ç”¨ç•Œé¢ã€‚
- **è´§å¸é€‰æ‹©:** å…è®¸ç”¨æˆ·é€‰æ‹©ä¸åŒçš„è´§å¸æ˜¾ç¤ºä»·æ ¼ã€‚

è¯·ä»£ç å®¡æŸ¥å‘˜æ£€æŸ¥ã€‚

---------- TextMessage (CodeReviewer) ----------
Enter your response: å¥½çš„ï¼Œæˆ‘æ¥å¯¹è¿™æ®µä»£ç è¿›è¡Œä»£ç å®¡æŸ¥ã€‚

**ä»£ç å®¡æŸ¥æŠ¥å‘Š**

**1. ä»£ç è´¨é‡**

- **å¯è¯»æ€§ï¼š** ä»£ç ç»“æ„æ¸…æ™°ï¼Œå‡½æ•°å’Œå˜é‡å‘½ååˆç†ï¼Œæ˜“äºç†è§£ã€‚ä½¿ç”¨äº†æ³¨é‡Šæ¥è§£é‡Šå…³é”®ä»£ç æ®µçš„åŠŸèƒ½ï¼Œæé«˜äº†å¯è¯»æ€§ã€‚
- **å¯ç»´æŠ¤æ€§ï¼š** ä»£ç æ¨¡å—åŒ–ç¨‹åº¦è¾ƒå¥½ï¼Œ`get_bitcoin_price` å’Œ `main` å‡½æ•°èŒè´£æ˜ç¡®ï¼Œæ–¹ä¾¿åç»­ä¿®æ”¹å’Œæ‰©å±•ã€‚ ä½¿ç”¨ `st.session_state` è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œé¿å…äº†ä¸å¿…è¦çš„ API è°ƒç”¨ã€‚
- **æ€§èƒ½ï¼š** æ¯æ¬¡ç‚¹å‡»åˆ·æ–°éƒ½ä¼šé‡æ–°è·å–æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘æ·»åŠ ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘ API è°ƒç”¨æ¬¡æ•°ã€‚

**2. å®‰å…¨æ€§**

- **API å¯†é’¥ï¼š** CoinGecko API æ— éœ€å¯†é’¥ï¼Œé¿å…äº†å¯†é’¥æ³„éœ²çš„é£é™©ã€‚å¦‚æœæ›´æ¢ä¸ºéœ€è¦å¯†é’¥çš„ APIï¼Œè¯·åŠ¡å¿…å¦¥å–„ä¿ç®¡å¯†é’¥ï¼Œé¿å…ç¡¬ç¼–ç åœ¨ä»£ç ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ– Streamlit secrets è¿›è¡Œç®¡ç†ã€‚
- **è¾“å…¥éªŒè¯ï¼š** ä»£ç ä¸­æ²¡æœ‰æ¶‰åŠç”¨æˆ·è¾“å…¥ï¼Œå› æ­¤ä¸å­˜åœ¨è¾“å…¥éªŒè¯é—®é¢˜ã€‚

**3. æœ€ä½³å®è·µ**

- **é”™è¯¯å¤„ç†ï¼š** ä½¿ç”¨ `try...except` å—æ•è· API è¯·æ±‚å’Œ JSON è§£ æå¯èƒ½å‡ºç°çš„å¼‚å¸¸ï¼Œå¹¶ä½¿ç”¨ `st.error` æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œå¢å¼ºäº†ç¨‹åºçš„å¥ å£®æ€§ã€‚
- **çŠ¶æ€ç®¡ç†ï¼š** ä½¿ç”¨ `st.session_state` è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œé¿å…äº†ä¸å¿…è¦çš„ API è°ƒç”¨ï¼Œç¬¦åˆ Streamlit çš„æœ€ä½³å®è·µã€‚
- **åŠ è½½çŠ¶æ€ï¼š** ä½¿ç”¨ `st.spinner` æ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

**4. æ½œåœ¨é—®é¢˜å’Œæ”¹è¿›ç‚¹**

- **è‡ªåŠ¨åˆ·æ–°ï¼š** ç›®å‰åªå®ç°äº†æ‰‹åŠ¨åˆ·æ–°ï¼Œå¯ä»¥è€ƒè™‘å¢åŠ è‡ªåŠ¨åˆ·æ–°åŠŸ èƒ½ã€‚ä½†éœ€è¦æ³¨æ„æ§åˆ¶åˆ·æ–°é¢‘ç‡ï¼Œé¿å…å¯¹ API é€ æˆè¿‡å¤§çš„å‹åŠ›ã€‚å¯ä»¥ä½¿ç”¨ `time.sleep()` å’Œ `st.rerun()` æ¥å®ç°è‡ªåŠ¨åˆ·æ–°ï¼Œæˆ–è€…ä½¿ç”¨ `streamlit.experimental_rerun`ã€‚
- **API é”™è¯¯å¤„ç†ï¼š** å½“ API å‡ºç°é”™è¯¯æ—¶ï¼Œåªæ˜¯ç®€å•åœ°æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œå¯ä»¥è€ƒè™‘å¢åŠ é‡è¯•æœºåˆ¶ï¼Œä¾‹å¦‚ä½¿ç”¨ `retry` åº“ã€‚
- **è´§å¸é€‰æ‹©ï¼š** ç›®å‰åªæ”¯æŒ USDï¼Œå¯ä»¥è€ƒè™‘å¢åŠ å…¶ä»–è´§å¸çš„æ”¯æŒï¼Œ å…è®¸ç”¨æˆ·é€‰æ‹©ã€‚
- **æ•°æ®æŒä¹…åŒ–ï¼š** å¦‚æœéœ€è¦é•¿æœŸä¿å­˜å†å²ä»·æ ¼æ•°æ®ï¼Œå¯ä»¥å°†æ•°æ®å­˜ å‚¨åˆ°æ•°æ®åº“æˆ–æ–‡ä»¶ä¸­ã€‚
- **æ ·å¼ç¾åŒ–ï¼š** å¯ä»¥ä½¿ç”¨ Streamlit çš„ä¸»é¢˜è®¾ç½®å’Œè‡ªå®šä¹‰ CSS æ¥ ç¾åŒ–åº”ç”¨ç•Œé¢ã€‚
- **å¼‚å¸¸å †æ ˆä¿¡æ¯ï¼š** ç°åœ¨çš„é”™è¯¯æç¤ºåªæ˜¾ç¤ºäº†é”™è¯¯ç±»å‹å’Œæ¶ˆæ¯ï¼Œå¦‚æœèƒ½æ˜¾ç¤ºå®Œæ•´çš„å¼‚å¸¸å †æ ˆä¿¡æ¯ï¼Œå°†æœ‰åŠ©äºè°ƒè¯•ã€‚å¯ä»¥ä½¿ç”¨ `traceback` æ¨¡å—æ¥è·å–å †æ ˆä¿¡æ¯ï¼Œä½†è¿™å¯èƒ½ä¼šæš´éœ²æ•æ„Ÿä¿¡æ¯ï¼Œéœ€è¦è°¨æ…å¤„ç†ã€‚
- **ä¾èµ–ç‰ˆæœ¬é”å®šï¼š** å»ºè®®åœ¨ `requirements.txt` æ–‡ä»¶ä¸­æŒ‡å®šä¾èµ–åº“çš„ç‰ˆæœ¬ï¼Œä»¥é¿å…å› ä¾èµ–åº“ç‰ˆæœ¬æ›´æ–°å¯¼è‡´çš„é—®é¢˜ã€‚

**5. ä¿®æ”¹å»ºè®®**

1.  **æ·»åŠ è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½ (å¯é€‰ï¼Œéœ€è°¨æ…)ï¼š**

```python
import streamlit as st
import requests
import time

def get_bitcoin_price():
    # ... (Your existing get_bitcoin_price function) ...

def main():
    st.title("æ¯”ç‰¹å¸ (Bitcoin) å®æ—¶ä»·æ ¼")

    # åˆå§‹åŒ– session state
    if 'price' not in st.session_state:
        st.session_state['price'] = None
        st.session_state['change'] = None

    # è‡ªåŠ¨åˆ·æ–°
    auto_refresh = st.checkbox("è‡ªåŠ¨åˆ·æ–°", value=False)
    refresh_interval = st.number_input("åˆ·æ–°é—´éš” (ç§’)", min_value=5, max_value=60, value=15, disabled=not auto_refresh)

    # è·å–ä»·æ ¼å¹¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    with st.spinner('æ­£åœ¨åŠ è½½æ¯”ç‰¹å¸ä»·æ ¼...'):
        price, change = get_bitcoin_price()
        st.session_state['price'] = price
        st.session_state['change'] = change

    # æ˜¾ç¤ºä»·æ ¼ä¿¡æ¯
    if st.session_state['price'] is not None:
        st.metric(label="å½“å‰ä»·æ ¼ (USD)", value=f"${st.session_state['price']:.2f}", delta=f"{st.session_state['change']:.2f}%")
    else:
        st.error("æ— æ³•è·å–æ¯”ç‰¹å¸ä»·æ ¼ï¼Œè¯·ç¨åå†è¯•ã€‚")

    # åˆ·æ–°æŒ‰é’®
    col1, col2 = st.columns(2) #ä½¿ç”¨columnsè®©æŒ‰é’®å’ŒåŠ è½½çŠ¶æ€åœ¨ä¸€è¡Œæ˜¾ç¤º
    with col1:
        if st.button("åˆ·æ–°ä»·æ ¼"):
            st.session_state['last_refresh'] = time.time() #è®°å½• åˆ·æ–°æ—¶é—´
            st.rerun() #ç«‹å³åˆ·æ–°
    with col2:
        #ä½¿ç”¨emptyå ä½ç¬¦ï¼Œæ˜¾ç¤ºåŠ è½½çŠ¶æ€
        placeholder = st.empty()

    # è‡ªåŠ¨åˆ·æ–°é€»è¾‘
    if auto_refresh:
        last_refresh = st.session_state.get('last_refresh', 0)
        if time.time() - last_refresh >= refresh_interval:
            with placeholder:
                st.write("æ­£åœ¨è‡ªåŠ¨åˆ·æ–°...") #æ˜¾ç¤ºè‡ªåŠ¨åˆ·æ–°æç¤º
            time.sleep(1) # æ¨¡æ‹ŸåŠ è½½æ—¶é—´ï¼Œé¿å…ç«‹å³åˆ·æ–°å¯¼è‡´UIé—ªçƒ
            st.session_state['last_refresh'] = time.time()
            st.rerun() #é‡æ–°è¿è¡Œ

if __name__ == "__main__":
    main()
```

2.  **æ·»åŠ ä¾èµ–ç‰ˆæœ¬é”å®šï¼š**
    åˆ›å»º `requirements.txt` æ–‡ä»¶ï¼Œå¹¶å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ–‡ä»¶ä¸­ï¼š

```
streamlit==1.29.0
requests==2.31.0
```

(è¯·æ ¹æ®ä½ å®é™…ä½¿ç”¨çš„åº“çš„ç‰ˆæœ¬è¿›è¡Œä¿®æ”¹)

**æ€»ç»“**

æ€»ä½“æ¥è¯´ï¼Œè¿™æ®µä»£ç è´¨é‡è¾ƒé«˜ï¼Œå®ç°äº†åŸºæœ¬åŠŸèƒ½ï¼Œå¹¶è€ƒè™‘äº†é”™è¯¯å¤„ç†å’Œç”¨æˆ·ä½“éªŒã€‚ é€šè¿‡ä»¥ä¸Šæ”¹è¿›å»ºè®®ï¼Œå¯ä»¥è¿›ä¸€æ­¥æå‡ä»£ç çš„å¥å£®æ€§ã€å¯ç»´æŠ¤æ€§å’Œç”¨æˆ·ä½“éªŒã€‚

ä»£ç å®¡æŸ¥å®Œæˆï¼Œè¯·ç”¨æˆ·ä»£ç†æµ‹è¯•ã€‚

å·²ç»å®Œæˆéœ€æ±‚
---------- TextMessage (UserProxy) ----------
å·²ç»å®Œæˆéœ€æ±‚
---------- TextMessage (ProductManager) ----------
å¥½çš„ï¼Œå·²å®Œæˆéœ€æ±‚ï¼Œå¯ä»¥ä¸Šçº¿éƒ¨ç½²ã€‚

---------- TextMessage (Engineer) ----------
æ”¶åˆ°ã€‚ç¥åº”ç”¨è¿è¡Œé¡ºåˆ©ï¼

---------- TextMessage (CodeReviewer) ----------
Enter your response: è°¢è°¢ï¼

TERMINATE
---------- TextMessage (UserProxy) ----------
TERMINATE

============================================================
âœ… å›¢é˜Ÿåä½œå®Œæˆï¼

ğŸ“‹ åä½œç»“æœæ‘˜è¦ï¼š

- å‚ä¸æ™ºèƒ½ä½“æ•°é‡ï¼š4 ä¸ª
- ä»»åŠ¡å®ŒæˆçŠ¶æ€ï¼šæˆåŠŸ
